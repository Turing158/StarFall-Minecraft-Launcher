<Page x:Class="StarFallMC.DownloadPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:comp="clr-namespace:StarFallMC.Component"
      mc:Ignorable="d"
      Title="Download" MinHeight="400" MinWidth="800" Background="Transparent">
    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Style/DownloadPageStyle.xaml"></ResourceDictionary>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Page.Resources>
    <Grid>
        <Border Style="{StaticResource FrameBg}"></Border>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="50"></ColumnDefinition>
                <ColumnDefinition Width="160"></ColumnDefinition>
                <ColumnDefinition Width="*"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0"
                        Margin="10 20 5 20">
                <comp:Button Width="25" Height="50" 
                             HorizontalAlignment="Right"
                             Click="Progress_OnClick">
                    <TextBlock Text="进度" TextWrapping="WrapWithOverflow"></TextBlock>
                </comp:Button>
                <comp:Button Width="25" Height="50" 
                             Margin="0 5"
                             HorizontalAlignment="Right"
                             Click="Download_OnClick">
                    <TextBlock Text="下载" TextWrapping="WrapWithOverflow"></TextBlock>
                </comp:Button>
            </StackPanel>
            <Grid Grid.Column="1" ClipToBounds="True">
                <Border Style="{StaticResource Rect}" Margin="0 20 10 20">
                    <Grid>
                        <Grid HorizontalAlignment="Center" VerticalAlignment="Top" 
                              Margin="0 20">
                            <Image Width="30" Height="30" 
                                   Source="assets/element/bedrock.png" 
                                   RenderOptions.BitmapScalingMode="NearestNeighbor" 
                                   Margin="0 10 20 0"></Image>
                            <Image Name="DiamondPickaxe" Width="32" Height="32" Source="assets/element/diamond_pickaxe.png" 
                                   RenderOptions.BitmapScalingMode="NearestNeighbor" 
                                   Margin="60 0 0 20"
                                   RenderTransformOrigin="0.1875,0.9375">
                                <Image.RenderTransform>
                                    <RotateTransform Angle="-50"></RotateTransform>
                                </Image.RenderTransform>
                            </Image>
                        </Grid>
                        <StackPanel VerticalAlignment="Center">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0 5">
                                <TextBlock Text="--.--" FontSize="20" 
                                           Foreground="{DynamicResource SecondaryBrush_2}"></TextBlock>
                                <TextBlock Text="Mb/s" Margin="5 0 0 2" 
                                           VerticalAlignment="Bottom" 
                                           Foreground="{DynamicResource SecondaryBrush}"></TextBlock>
                            </StackPanel>
                            <Grid Margin="0 20" ToolTip="我是能点的！">
                                <StackPanel HorizontalAlignment="Center">
                                    <StackPanel Orientation="Horizontal" Margin="10 2">
                                        <TextBlock Text="总共:" FontSize="14" Foreground="{DynamicResource SecondaryBrush_2}"></TextBlock>
                                        <TextBlock Text="{Binding Total}" 
                                                   HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                                                   Margin="2 0 0 1" Foreground="{DynamicResource SecondaryBrush}"></TextBlock>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="10 2">
                                        <TextBlock Text="剩余:" FontSize="14" 
                                                   Foreground="{DynamicResource SecondaryBrush_2}"></TextBlock>
                                        <TextBlock Text="{Binding Remaining}" 
                                                   HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                                                   Margin="2 0 0 1" Foreground="{DynamicResource SecondaryBrush}"></TextBlock>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="10 2">
                                        <TextBlock Text="成功:" FontSize="14" 
                                                   Foreground="{DynamicResource SecondaryBrush_2}"></TextBlock>
                                        <TextBlock Text="{Binding Finished}" 
                                                   HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                                                   Margin="2 0 0 0" Foreground="{DynamicResource SecondaryBrush}"></TextBlock>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="10 2">
                                        <TextBlock Text="失败:" FontSize="14" 
                                                   Foreground="{DynamicResource SecondaryBrush_2}"></TextBlock>
                                        <TextBlock Text="{Binding ErrorCount}" 
                                                   HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                                                   Margin="2 0 0 0" Foreground="{DynamicResource SecondaryBrush}"></TextBlock>
                                    </StackPanel>
                                </StackPanel>
                                <Grid Name="ProgressGrid" Background="{DynamicResource PrimaryBrush}" 
                                      Opacity="1" Margin="1 0" 
                                      MouseLeftButtonDown="ProgressGrid_OnMouseLeftButtonDown">
                                    <TextBlock HorizontalAlignment="Center" FontSize="16" Text="- 进度 -" 
                                               Foreground="{DynamicResource SecondaryBrush}" 
                                               Margin="0 10"></TextBlock>
                                    <StackPanel Orientation="Horizontal" 
                                                HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding Remaining}" FontSize="18" 
                                                   Foreground="{DynamicResource SecondaryBrush_2}"></TextBlock>
                                        <TextBlock Text="/" Margin="5 0" FontSize="18" 
                                                   Foreground="{DynamicResource SecondaryBrush}"></TextBlock>
                                        <TextBlock Text="{Binding Total}" FontSize="18" 
                                                   Foreground="{DynamicResource SecondaryBrush_2}"></TextBlock>
                                    </StackPanel>
                                    <TextBlock Text="{Binding ProgressText}" 
                                               HorizontalAlignment="Center" VerticalAlignment="Bottom" 
                                               Margin="0 5" FontSize="14" 
                                               Foreground="{DynamicResource SecondaryBrush}"></TextBlock>
                                </Grid>
                            </Grid>
                        </StackPanel>
                        <StackPanel Name="OperateBtn"
                                    Height="35" 
                                    HorizontalAlignment="Center" 
                                    VerticalAlignment="Bottom"
                                    Margin="0 10"
                                    Orientation="Horizontal">
                            <comp:Button x:Name="CancelAndCleanDownload" Width="65"
                                    Content="取 消" FontSize="15" 
                                    Click="CancelAndCleanDownload_OnClick"
                                    Margin="5 0"></comp:Button>
                            <comp:Button x:Name="RetryAndContinueDownload" Width="65"
                                              Content="重 试" FontSize="15" 
                                              Click="RetryAndContinueDownload_OnClick"
                                              Margin="5 0"></comp:Button>
                        </StackPanel>
                    </Grid>
                </Border>
                <Border Name="ProcessInfo" 
                        Style="{StaticResource Rect}" 
                        Margin="0 20 10 20"
                        RenderTransformOrigin="1,0">
                    <Border.RenderTransform>
                        <TranslateTransform></TranslateTransform>
                    </Border.RenderTransform>
                    <Grid>
                        <TextBlock FontSize="18" Foreground="{DynamicResource SecondaryBrush}"
                                   HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Run Text="进"></Run>
                            <LineBreak></LineBreak>
                            <Run Text="度"></Run>
                            <LineBreak></LineBreak>
                            <Run Text="测"></Run>
                            <LineBreak></LineBreak>
                            <Run Text="试"></Run>
                            <LineBreak></LineBreak>
                            <Run Text="中"></Run>
                        </TextBlock>
                    </Grid>
                </Border>
            </Grid>
            <Grid Grid.Column="2" Margin="10 20 30 20" ClipToBounds="True">
                <Border Height="50" VerticalAlignment="Top" 
                        Background="{DynamicResource PrimaryBrush_2}" 
                        Style="{StaticResource Rect}">
                    <comp:NavigationBar x:Name="DownloadNavigationBar" 
                                        HorizontalAlignment="Center" VerticalAlignment="Top" ItemsSource="{Binding DownloadStates}" 
                                        Margin="0 2 0 0"
                                        SelectedIndex="0"
                                        SelectionChanged="Selector_OnSelectionChanged"></comp:NavigationBar>
                </Border>
                <Border Style="{StaticResource Rect}" Margin="0 40 0 0">
                    <Grid Name="DownloadList">
                        <TextBlock Name="EmptyList" FontSize="18" 
                                   Foreground="{DynamicResource SecondaryBrush}" 
                                   Text="没有任何下载项" 
                                   HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                        <ListView Name="ListScrollViewer" Margin="0 5" 
                                  ItemsSource="{Binding Downloads}">
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <VirtualizingStackPanel></VirtualizingStackPanel>
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                        </ListView>
                    </Grid>
                </Border>
                <Border Name="ProcessAllInfo" 
                        Style="{StaticResource Rect}"
                        RenderTransformOrigin="0,0">
                    <Border.RenderTransform>
                        <TranslateTransform></TranslateTransform>
                    </Border.RenderTransform>
                    <comp:ProcessProgresses x:Name="ProcessProgresses" Progresses="{Binding Progresses}"></comp:ProcessProgresses>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</Page>