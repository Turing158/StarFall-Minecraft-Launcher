<ScrollViewer x:Class="StarFallMC.Component.NavigationBar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:StarFallMC.Component"
             mc:Ignorable="d"
             d:DesignHeight="300" d:DesignWidth="300" 
             Background="#00ffffff"
             BorderThickness="0" Margin="0" VerticalScrollBarVisibility="Hidden">
    <ScrollViewer.Resources>
        <Style TargetType="ListViewItem" BasedOn="{StaticResource {x:Type ListViewItem}}">
            <Setter Property="Margin" Value="{Binding ItemMargin, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"></Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListViewItem">
                        <Grid Name="Main"
                              RenderTransformOrigin="0.5,0.5"
                              Width="{Binding ItemWidth, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                              Height="{Binding ItemHeight, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}">
                            <Border Name="Bg" 
                                    CornerRadius="{Binding ItemRadius, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}" 
                                    Background="{Binding ItemBackground, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                                    Opacity="0.1"></Border>
                            <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock Text="{Binding Name}"
                                           Margin="{Binding ItemPadding, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                                           FontSize="{Binding ItemFontSize, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                                           Foreground="{Binding ItemForeground, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"/>
                                <TextBlock Name="ActiveText"
                                           Text="{Binding Name}"
                                           Margin="{Binding ItemPadding, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                                           FontSize="{Binding ItemFontSize, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                                           Foreground="{Binding ActiveForeground, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                                           Opacity="0"/>
                            </Grid>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="ActiveText" Storyboard.TargetProperty="Opacity"
                                                             To="1" Duration="0:0:0.2"></DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="ActiveText" Storyboard.TargetProperty="Opacity"
                                                             To="0" Duration="0:0:0.2"></DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="Bg" TargetProperty="Opacity">
                                            <DoubleAnimation To="0.3" Duration="0:0:0.2"></DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="Bg" TargetProperty="Opacity">
                                            <DoubleAnimation To="0.1" Duration="0:0:0.2"></DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </ScrollViewer.Resources>
    <Grid Margin="0">
        <Border Name="ActiveBlock" 
                Background="{Binding ActiveBlockColor, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Margin="0"
                CornerRadius="{Binding ItemRadius, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}">
            <Border.RenderTransform>
                <TranslateTransform></TranslateTransform>
            </Border.RenderTransform>
        </Border>
        <ListView Name="ListView" 
                  Margin="0"
                  Padding="0"
                  ItemsSource="{Binding ItemsSource, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                  SelectedIndex="{Binding SelectedIndex, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}"
                  SelectionChanged="Selector_OnSelectionChanged"
                  Loaded="ListView_OnLoaded">
            <ListView.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel Margin="0"
                        Orientation="{Binding Orientation, RelativeSource={RelativeSource AncestorType=local:NavigationBar}}">
                    </VirtualizingStackPanel>
                </ItemsPanelTemplate>
            </ListView.ItemsPanel>
        </ListView>
    </Grid>
</ScrollViewer>
